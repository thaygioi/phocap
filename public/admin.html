<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Quáº£n trá»‹ tuyá»ƒn sinh</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; }
    th { background: #f2f2f2; }
    select { padding: 4px; }
  </style>
</head>
<body>

<h2>ğŸ“‹ Danh sÃ¡ch Ä‘Äƒng kÃ½ tuyá»ƒn sinh</h2>

<table>
  <thead>
    <tr>
      <th>Há»c sinh</th>
      <th>NgÃ y sinh</th>
      <th>Phá»¥ huynh</th>
      <th>SÄT</th>
      <th>Tráº¡ng thÃ¡i</th>
    </tr>
  </thead>
  <tbody id="data"></tbody>
</table>

<script>
  const supabase = supabase.createClient(
    "https://zvhxivunrffjoskqbivw.supabase.co",
    "sb_publishable_e-hT6FP8ZxiVSU_TYKHqkA_r4FLQ4Ss"
  );

  async function loadData() {
    const { data, error } = await supabase
      .from("applications")
      .select("*")
      .order("created_at", { ascending: false });

    if (error) {
      alert(error.message);
      return;
    }

    const tbody = document.getElementById("data");
    tbody.innerHTML = "";

    data.forEach(row => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row.full_name}</td>
        <td>${row.birthday || ""}</td>
        <td>${row.parent_name || ""}</td>
        <td>${row.phone || ""}</td>
        <td>
          <select onchange="updateStatus('${row.id}', this.value)">
            <option ${row.status === 'ChÆ°a xá»­ lÃ½' ? 'selected' : ''}>ChÆ°a xá»­ lÃ½</option>
            <option ${row.status === 'ÄÃ£ tiáº¿p nháº­n' ? 'selected' : ''}>ÄÃ£ tiáº¿p nháº­n</option>
            <option ${row.status === 'ÄÃ£ duyá»‡t' ? 'selected' : ''}>ÄÃ£ duyá»‡t</option>
          </select>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  async function updateStatus(id, status) {
    const { error } = await supabase
      .from("applications")
      .update({ status })
      .eq("id", id);

    if (error) alert(error.message);
  }

  loadData();
</script>

</body>
</html>
